<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shellder - Aegis AIO Control Panel</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="logo">
                <div class="logo-icon">üêö</div>
                <div class="logo-text">
                    <span class="logo-name">Shellder</span>
                    <span class="logo-version">v1.0</span>
                </div>
            </div>
            
            <div class="nav-section">
                <div class="nav-label">Overview</div>
                <a href="#" class="nav-item active" data-page="dashboard">
                    <span class="nav-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-page="containers">
                    <span class="nav-icon">üê≥</span>
                    <span>Containers</span>
                </a>
            </div>
            
            <div class="nav-section">
                <div class="nav-label">Monitoring</div>
                <a href="#" class="nav-item" data-page="stack">
                    <span class="nav-icon">üéÆ</span>
                    <span>Stack Data</span>
                </a>
                <a href="#" class="nav-item" data-page="xilriws">
                    <span class="nav-icon">üîê</span>
                    <span>Xilriws</span>
                </a>
                <a href="#" class="nav-item" data-page="stats">
                    <span class="nav-icon">üìà</span>
                    <span>Statistics</span>
                </a>
            </div>
            
            <div class="nav-section">
                <div class="nav-label">Management</div>
                <a href="#" class="nav-item" data-page="files">
                    <span class="nav-icon">üìÅ</span>
                    <span>Files</span>
                </a>
                <a href="#" class="nav-item" data-page="scripts">
                    <span class="nav-icon">‚ö°</span>
                    <span>Scripts</span>
                </a>
                <a href="#" class="nav-item" data-page="logs">
                    <span class="nav-icon">üìú</span>
                    <span>Logs</span>
                </a>
                <a href="#" class="nav-item" data-page="updates">
                    <span class="nav-icon">üîÑ</span>
                    <span>Updates</span>
                </a>
            </div>
            
            <div class="sidebar-footer">
                <div class="status-indicator">
                    <span class="status-dot" id="connectionStatus"></span>
                    <span id="connectionText">Connecting...</span>
                </div>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="main-content">
            <header class="header">
                <h1 id="pageTitle">Dashboard</h1>
                <div class="header-actions">
                    <button class="btn btn-icon" onclick="refreshData()" title="Refresh">üîÑ</button>
                    <span class="last-update" id="lastUpdate">--</span>
                </div>
            </header>
            
            <!-- Dashboard Page -->
            <div id="page-dashboard" class="page active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon running">üê≥</div>
                        <div class="stat-info">
                            <div class="stat-value" id="containersRunning">-</div>
                            <div class="stat-label">Running</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon stopped">‚èπÔ∏è</div>
                        <div class="stat-info">
                            <div class="stat-value" id="containersStopped">-</div>
                            <div class="stat-label">Stopped</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon memory">üíæ</div>
                        <div class="stat-info">
                            <div class="stat-value" id="memoryUsed">-</div>
                            <div class="stat-label">Memory Used</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon disk">üíø</div>
                        <div class="stat-info">
                            <div class="stat-value" id="diskUsed">-</div>
                            <div class="stat-label">Disk Used</div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-grid">
                    <div class="card">
                        <div class="card-header">
                            <h2>Quick Actions</h2>
                        </div>
                        <div class="card-body">
                            <div class="action-grid">
                                <button class="action-btn" onclick="dockerAction('up')">
                                    <span class="action-icon">‚ñ∂Ô∏è</span>
                                    <span>Start All</span>
                                </button>
                                <button class="action-btn" onclick="dockerAction('down')">
                                    <span class="action-icon">‚èπÔ∏è</span>
                                    <span>Stop All</span>
                                </button>
                                <button class="action-btn" onclick="dockerAction('restart')">
                                    <span class="action-icon">üîÑ</span>
                                    <span>Restart All</span>
                                </button>
                                <button class="action-btn" onclick="dockerAction('pull')">
                                    <span class="action-icon">‚¨áÔ∏è</span>
                                    <span>Pull Images</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>System Info</h2>
                        </div>
                        <div class="card-body">
                            <div class="info-list">
                                <div class="info-item">
                                    <span class="info-label">Uptime</span>
                                    <span class="info-value" id="systemUptime">-</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Memory</span>
                                    <span class="info-value" id="memoryInfo">-</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Disk</span>
                                    <span class="info-value" id="diskInfo">-</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Config</span>
                                    <span class="info-value" id="envStatus">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-grid">
                    <div class="card">
                        <div class="card-header">
                            <h2>Container Status</h2>
                        </div>
                        <div class="card-body">
                            <div id="containerList" class="container-list">
                                <div class="loading">Loading containers...</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Xilriws Proxy Status</h2>
                        </div>
                        <div class="card-body">
                            <div id="xilriwsStats" class="xilriws-panel">
                                <div class="loading">Loading Xilriws stats...</div>
                            </div>
                            <div class="xilriws-details" id="xilriwsDetails">
                                <!-- Details populated by JS -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Containers Page -->
            <div id="page-containers" class="page">
                <div class="card full-height">
                    <div class="card-header">
                        <h2>Docker Containers</h2>
                        <div class="card-actions">
                            <button class="btn btn-sm" onclick="dockerAction('up')">Start All</button>
                            <button class="btn btn-sm btn-danger" onclick="dockerAction('down')">Stop All</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="containerDetailList" class="container-detail-list">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Scripts Page -->
            <div id="page-scripts" class="page">
                <div class="card">
                    <div class="card-header">
                        <h2>Shellder Scripts</h2>
                        <p class="card-subtitle">Run scripts via terminal for full interactivity</p>
                    </div>
                    <div class="card-body">
                        <div class="scripts-grid">
                            <div class="script-card" onclick="showScriptInfo('setup.sh')">
                                <div class="script-icon">üöÄ</div>
                                <div class="script-name">Initial Setup</div>
                                <div class="script-desc">First-time configuration</div>
                            </div>
                            <div class="script-card" onclick="showScriptInfo('dbsetup.sh')">
                                <div class="script-icon">üóÑÔ∏è</div>
                                <div class="script-name">Database Manager</div>
                                <div class="script-desc">MariaDB setup & maintenance</div>
                            </div>
                            <div class="script-card" onclick="showScriptInfo('nginx-setup.sh')">
                                <div class="script-icon">üîí</div>
                                <div class="script-name">Security Setup</div>
                                <div class="script-desc">Nginx & SSL configuration</div>
                            </div>
                            <div class="script-card" onclick="showScriptInfo('check.sh')">
                                <div class="script-icon">‚úÖ</div>
                                <div class="script-name">System Check</div>
                                <div class="script-desc">Verify configuration</div>
                            </div>
                            <div class="script-card" onclick="showScriptInfo('logs.sh')">
                                <div class="script-icon">üìã</div>
                                <div class="script-name">Log Manager</div>
                                <div class="script-desc">View Docker logs</div>
                            </div>
                            <div class="script-card" onclick="showScriptInfo('files.sh')">
                                <div class="script-icon">üìÅ</div>
                                <div class="script-name">File Manager</div>
                                <div class="script-desc">Git & file operations</div>
                            </div>
                            <div class="script-card" onclick="showScriptInfo('poracle.sh')">
                                <div class="script-icon">üîî</div>
                                <div class="script-name">Poracle Setup</div>
                                <div class="script-desc">Notification system</div>
                            </div>
                            <div class="script-card" onclick="showScriptInfo('fletchling.sh')">
                                <div class="script-icon">üê¶</div>
                                <div class="script-name">Fletchling Setup</div>
                                <div class="script-desc">Quest scanning</div>
                            </div>
                        </div>
                        
                        <div class="terminal-hint">
                            <div class="hint-icon">üí°</div>
                            <div class="hint-text">
                                <strong>To run scripts with full interactivity:</strong>
                                <code>sudo bash shellder.sh</code>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Logs Page -->
            <div id="page-logs" class="page">
                <div class="card full-height">
                    <div class="card-header">
                        <h2>Shellder Logs</h2>
                        <div class="card-actions">
                            <select id="logLines" onchange="loadShellderLogs()">
                                <option value="50">Last 50 lines</option>
                                <option value="100" selected>Last 100 lines</option>
                                <option value="200">Last 200 lines</option>
                                <option value="500">Last 500 lines</option>
                            </select>
                            <button class="btn btn-sm" onclick="loadShellderLogs()">Refresh</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <pre id="logContent" class="log-viewer">Loading logs...</pre>
                    </div>
                </div>
            </div>
            
            <!-- Updates Page -->
            <div id="page-updates" class="page">
                <div class="card">
                    <div class="card-header">
                        <h2>Updates</h2>
                    </div>
                    <div class="card-body">
                        <div id="gitStatus" class="git-status">
                            <div class="loading">Checking for updates...</div>
                        </div>
                        
                        <div class="update-actions">
                            <button class="btn btn-primary" onclick="gitPull()">
                                <span>‚¨áÔ∏è</span> Pull Updates
                            </button>
                        </div>
                        
                        <div id="updateOutput" class="update-output" style="display: none;">
                            <pre></pre>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Stack Data Page - Cross-Referenced Database Stats -->
            <div id="page-stack" class="page">
                <!-- Connection Status -->
                <div class="stack-connection" id="stackConnection">
                    <div class="loading">Connecting to stack database...</div>
                </div>
                
                <!-- Main Stats Grid -->
                <div class="stats-grid stack-stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon success">üìç</div>
                        <div class="stat-info">
                            <div class="stat-value" id="stackPokemon">-</div>
                            <div class="stat-label">Active Pokemon</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üë§</div>
                        <div class="stat-info">
                            <div class="stat-value" id="stackAccounts">-</div>
                            <div class="stat-label">Active Accounts</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üì±</div>
                        <div class="stat-info">
                            <div class="stat-value" id="stackDevices">-</div>
                            <div class="stat-label">Online Devices</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚ö°</div>
                        <div class="stat-info">
                            <div class="stat-value" id="stackEfficiency">-</div>
                            <div class="stat-label">Pokemon/Hour</div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-grid stack-grid">
                    <!-- Scanner Health -->
                    <div class="card">
                        <div class="card-header">
                            <h2>üéÆ Scanner Overview</h2>
                            <button class="btn btn-sm btn-icon" onclick="refreshStackData()">üîÑ</button>
                        </div>
                        <div class="card-body">
                            <div id="scannerStats" class="scanner-stats">
                                <div class="loading">Loading scanner data...</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Account Health -->
                    <div class="card">
                        <div class="card-header">
                            <h2>üë§ Account Health</h2>
                        </div>
                        <div class="card-body">
                            <div id="accountStats" class="account-stats">
                                <div class="loading">Loading account data...</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Map Data -->
                    <div class="card">
                        <div class="card-header">
                            <h2>üó∫Ô∏è Map Data (Golbat)</h2>
                        </div>
                        <div class="card-body">
                            <div id="golbatStats" class="golbat-stats">
                                <div class="loading">Loading Golbat data...</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Geofencing -->
                    <div class="card">
                        <div class="card-header">
                            <h2>üìê Geofencing (Koji)</h2>
                        </div>
                        <div class="card-body">
                            <div id="kojiStats" class="koji-stats">
                                <div class="loading">Loading Koji data...</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Device List -->
                <div class="card full-width">
                    <div class="card-header">
                        <h2>üì± Connected Devices</h2>
                        <span class="device-count" id="deviceCount">0 devices</span>
                    </div>
                    <div class="card-body">
                        <div id="deviceList" class="device-list">
                            <div class="loading">Loading device list...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Xilriws Page -->
            <div id="page-xilriws" class="page">
                <!-- Main Stats -->
                <div class="stats-grid xilriws-stats-grid">
                    <div class="stat-card large">
                        <div class="stat-icon success">‚úì</div>
                        <div class="stat-info">
                            <div class="stat-value" id="xilSuccessRate">--%</div>
                            <div class="stat-label">Success Rate</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon success">üü¢</div>
                        <div class="stat-info">
                            <div class="stat-value" id="xilSuccessful">-</div>
                            <div class="stat-label">Successful Auth</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon danger">üî¥</div>
                        <div class="stat-info">
                            <div class="stat-value" id="xilFailed">-</div>
                            <div class="stat-label">Failed</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-info">
                            <div class="stat-value" id="xilTotal">-</div>
                            <div class="stat-label">Total Requests</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon warning">üç™</div>
                        <div class="stat-info">
                            <div class="stat-value" id="xilCookieStatus">-/-</div>
                            <div class="stat-label">Cookie Storage</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" id="criticalIcon">‚ö†Ô∏è</div>
                        <div class="stat-info">
                            <div class="stat-value" id="xilCritical">0</div>
                            <div class="stat-label">Critical Events</div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-grid xilriws-grid">
                    <!-- Error Breakdown - Updated categories -->
                    <div class="card">
                        <div class="card-header">
                            <h2>üî¥ Error Breakdown</h2>
                        </div>
                        <div class="card-body">
                            <div id="xilErrorBreakdown" class="error-breakdown">
                                <div class="error-section">
                                    <h4>Account Status</h4>
                                    <div class="error-row">
                                        <span class="error-type">üö´ Account Banned (418)</span>
                                        <span class="error-count" id="xilAuthBanned">0</span>
                                    </div>
                                    <div class="error-row">
                                        <span class="error-type">üîÑ Max Retries Exceeded</span>
                                        <span class="error-count" id="xilMaxRetries">0</span>
                                    </div>
                                    <div class="error-row">
                                        <span class="error-type">üí• Internal Server Error</span>
                                        <span class="error-count" id="xilInternalError">0</span>
                                    </div>
                                </div>
                                <div class="error-section">
                                    <h4>Browser Issues</h4>
                                    <div class="error-row">
                                        <span class="error-type">üõ°Ô∏è Bot Protection (Code 15)</span>
                                        <span class="error-count" id="xilCode15">0</span>
                                    </div>
                                    <div class="error-row">
                                        <span class="error-type">‚è±Ô∏è Page Timeout</span>
                                        <span class="error-count" id="xilBrowserTimeout">0</span>
                                    </div>
                                    <div class="error-row">
                                        <span class="error-type">üåê Page Unreachable</span>
                                        <span class="error-count" id="xilBrowserUnreachable">0</span>
                                    </div>
                                    <div class="error-row">
                                        <span class="error-type">‚è≥ JS Challenge Timeout</span>
                                        <span class="error-count" id="xilJSTimeout">0</span>
                                    </div>
                                </div>
                                <div class="error-section">
                                    <h4>Connection Issues</h4>
                                    <div class="error-row">
                                        <span class="error-type">üöá Tunnel Failed (407)</span>
                                        <span class="error-count" id="xilTunnelFailed">0</span>
                                    </div>
                                    <div class="error-row">
                                        <span class="error-type">‚è∞ Connection Timeout</span>
                                        <span class="error-count" id="xilConnTimeout">0</span>
                                    </div>
                                    <div class="error-row">
                                        <span class="error-type">üîê Captcha Triggered</span>
                                        <span class="error-count" id="xilCaptcha">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Proxy Stats -->
                    <div class="card">
                        <div class="card-header">
                            <h2>üåê Proxy Performance</h2>
                            <span class="badge" id="currentProxyBadge">Current: --</span>
                        </div>
                        <div class="card-body">
                            <div id="proxyStats" class="proxy-stats-container">
                                <div class="loading">Loading proxy stats...</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Recent Errors -->
                <div class="card">
                    <div class="card-header">
                        <h2>‚ö° Recent Errors</h2>
                        <span class="badge error-badge" id="errorCount">0 errors</span>
                    </div>
                    <div class="card-body">
                        <div id="recentErrors" class="recent-errors-list">
                            <div class="no-data">No recent errors</div>
                        </div>
                    </div>
                </div>
                
                <!-- Live Logs -->
                <div class="card full-height">
                    <div class="card-header">
                        <h2>üìú Live Xilriws Logs</h2>
                        <div class="card-actions">
                            <select id="logFilter" class="log-filter" onchange="filterXilriwsLogs()">
                                <option value="all">All Logs</option>
                                <option value="success">Success Only</option>
                                <option value="error">Errors Only</option>
                                <option value="warning">Warnings Only</option>
                                <option value="proxy">Proxy Events</option>
                            </select>
                            <label class="toggle-label">
                                <input type="checkbox" id="xilLiveToggle" onchange="toggleXilriwsLive()" checked>
                                <span>Auto-scroll</span>
                            </label>
                            <button class="btn btn-sm" onclick="loadXilriwsLogs()">Refresh</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <pre id="xilriwsLogContent" class="log-viewer live-log">Connecting to Xilriws logs...</pre>
                    </div>
                </div>
            </div>
            
            <!-- Statistics Page -->
            <div id="page-stats" class="page">
                <div class="card">
                    <div class="card-header">
                        <h2>Historical Statistics</h2>
                        <div class="card-actions">
                            <select id="statsTimeRange" onchange="loadHistoricalStats()">
                                <option value="1">Last 24 hours</option>
                                <option value="7" selected>Last 7 days</option>
                                <option value="30">Last 30 days</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="stats-chart-container">
                            <canvas id="statsChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-grid">
                    <div class="card">
                        <div class="card-header">
                            <h2>All-Time Proxy Stats</h2>
                        </div>
                        <div class="card-body">
                            <div id="allTimeProxyStats" class="stats-table-container">
                                <table class="stats-table">
                                    <thead>
                                        <tr>
                                            <th>Proxy</th>
                                            <th>Total</th>
                                            <th>Success</th>
                                            <th>Failed</th>
                                            <th>Rate</th>
                                        </tr>
                                    </thead>
                                    <tbody id="proxyStatsBody">
                                        <tr><td colspan="5" class="loading">Loading...</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Recent System Events</h2>
                        </div>
                        <div class="card-body">
                            <div id="systemEvents" class="event-list">
                                <div class="loading">Loading events...</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2>Container Uptime History</h2>
                    </div>
                    <div class="card-body">
                        <div id="containerHistory" class="container-history">
                            <div class="loading">Loading container history...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Files Page -->
            <div id="page-files" class="page">
                <div class="card full-height">
                    <div class="card-header">
                        <h2>File Browser</h2>
                        <div class="card-actions">
                            <button class="btn btn-sm" onclick="navigateToPath('')">üè† Root</button>
                            <button class="btn btn-sm" onclick="navigateUp()">‚¨ÜÔ∏è Up</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="file-path-bar">
                            <span class="path-label">Path:</span>
                            <span id="currentPath" class="current-path">/</span>
                        </div>
                        <div id="fileList" class="file-list">
                            <div class="loading">Loading files...</div>
                        </div>
                    </div>
                </div>
                
                <!-- File Viewer Modal Content -->
                <div id="fileViewer" class="file-viewer" style="display: none;">
                    <div class="file-viewer-header">
                        <span id="fileViewerName">filename.txt</span>
                        <button class="btn btn-sm" onclick="closeFileViewer()">‚úï Close</button>
                    </div>
                    <pre id="fileViewerContent" class="file-content"></pre>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Title</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                Content
            </div>
            <div class="modal-footer" id="modalFooter">
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>
    
    <!-- Socket.IO for WebSocket support -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="/static/script.js"></script>
</body>
</html>


